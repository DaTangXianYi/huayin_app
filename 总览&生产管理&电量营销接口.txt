*** Settings ***
Library           Selenium2Library    timeout=100
Library           requests
Library           RequestsLibrary
Library           DatabaseLibrary
Library           Collections
Library           demjson

*** Test Cases ***
GetOverViewInfo
    Create Session    api    http://10.232.234.210:8800
    ${addr}    get request    api    HyAppService.svc/GetOverViewInfo
    Should Be Equal As Strings    ${addr.status_code}    200    #判断请求响应是否为200，服务器成功返回网页
    log    ${addr.content}    #打印接口返回值
    ${responsedate}    to json    ${addr.content}    #使用to json将string转换为json串
    ${keys}    Get Dictionary Keys    ${responsedate}
    ${items}    Get Dictionary items    ${responsedate}
    ${values}    Get Dictionary values    ${responsedate}
    ${day_fdl}    get from dictionary    ${responsedate}    day_fdl
    ${fh}    get from dictionary    ${responsedate}    fh
    ${fhl}    get from dictionary    ${responsedate}    fhl
    ${month_fdl}    get from dictionary    ${responsedate}    month_fdl
    ${year_fdl}    get from dictionary    ${responsedate}    year_fdl

GetLoadStock
    Create Session    api    http://10.232.234.210:8800
    ${userId}    Set Variable    ff8080816218fa3801626f5e554c00e0    #设置参数userId
    ${timeType}    Set Variable    3    #设置参数timeType，时间类型：1 近6小时 \ \ 2 近24小时 \ 3 近两天
    ${addr}    get request    api    HHyAppService.svc/GetLoadStock?userId=${userId}&timeType=${timeType}
    Should Be Equal As Strings    ${addr.status_code}    200    #判断请求响应是否为200，服务器成功返回网页
    log    ${addr.content}    #打印接口返回值
    ${addr.contentDic}    decode    "{addr.content}"
    log    ${addr.contentDic}

GetOverViewInfoForfac
    Create Session    api    http://10.232.234.210:8800
    ${deptGuid}    Set Variable    1a15920c-8a43-40cd-93a8-a0a481e5aeca    #设置参数deptGuid
    ${addr}    get request    api    HyAppService.svc/GetOverViewInfoForfac?deptGuid=${deptGuid}
    Should Be Equal As Strings    ${addr.status_code}    200    #判断请求响应是否为200，服务器成功返回网页
    log    ${addr.content}    #打印接口返回值

GetFacRealDataForEnergyType
    Create Session    api    http://10.232.234.210:8800
    ${userId}    Set Variable    ff8080816218fa3801626f5e554c00e0    #设置参数userId
    ${energyType}    Set Variable    0    #设置参数energyType，能源类型0 火电 1 水电
    ${addr}    get request    api    HyAppService.svc/GetFacRealDataForEnergyType?userId=${userId}&energyType=${energyType}
    Should Be Equal As Strings    ${addr.status_code}    200    #判断请求响应是否为200，服务器成功返回网页
    log    ${addr.content}    #打印接口返回值
    ${responsedate}    to json    ${addr.content}    #使用to json将string转换为json串
    ${keys}    Get Dictionary Keys    ${responsedate}
    ${items}    Get Dictionary items    ${responsedate}
    ${values}    Get Dictionary values    ${responsedate}
    ${FactoryInfoList}    get from dictionary    ${responsedate}    FactoryInfoList
    ${fh}    get from dictionary    ${responsedate}    fh

GetWindRealDataForFac
    Create Session    api    http://10.232.234.210:8800
    ${userId}    Set Variable    ff8080816218fa3801626f5e554c00e0    #设置参数userId
    ${addr}    get request    api    HyAppService.svc/GetWindRealDataForFac?userId=${userId}
    Should Be Equal As Strings    ${addr.status_code}    200    #判断请求响应是否为200，服务器成功返回网页
    log    ${addr.content}    #打印接口返回值
    ${responsedate}    to json    ${addr.content}    #使用to json将string转换为json串
    ${addr.content.list}    Get Slice From List    ${addr.content}    0    150

GetMachineList
    Create Session    api    http://10.232.234.210:8800
    ${deptGuid}    Set Variable    1a15920c-8a43-40cd-93a8-a0a481e5aeca    #设置参数deptGuid
    ${addr}    get request    api    HyAppService.svc/GetMachineList?deptGuid=${deptGuid}
    Should Be Equal As Strings    ${addr.status_code}    200    #判断请求响应是否为200，服务器成功返回网页
    log    ${addr.content}    #打印接口返回值
    ${responsedate}    to json    ${addr.content}    #使用to json将string转换为json串
    ${keys}    Get Dictionary Keys    ${responsedate}
    ${dict0}    get from list    ${responsedate}    0
    ${keys1}    Get Dictionary Keys    ${dict0}
    ${Code}    get from dictionary    ${dict0}    Code
    ${Text}    get from dictionary    ${dict0}    Text
    ${Value}    get from dictionary    ${dict0}    Value
    ${energyType}    get from dictionary    ${dict0}    energyType

GetMainParamInfo
    Create Session    api    http://10.232.234.210:8800
    ${deptGuid}    Set Variable    98cb3257-e332-404c-b4f9-f886c2a61dce    #设置参数deptGuid
    ${energyType}    Set Variable    0    #设置参数energyType
    ${addr}    get request    api    HyAppService.svc/GetMainParamInfo?deptGuid=${deptGuid}&energyType=${energyType}
    Should Be Equal As Strings    ${addr.status_code}    200    #判断请求响应是否为200，服务器成功返回网页
    log    ${addr.content}    #打印接口返回值
    ${responsedate}    to json    ${addr.content}    #使用to json将string转换为json串
    ${keys}    Get Dictionary Keys    ${responsedate}
    ${energyType}    get from dictionary    ${responsedate}    energyType
    ${guid}    get from dictionary    ${responsedate}    guid
    ${machineName}    get from dictionary    ${responsedate}    machineName
    ${paramInfoList}    get from dictionary    ${responsedate}    paramInfoList
    ${dict0}    get from list    ${paramInfoList}    0
    ${typeName}    get from dictionary    ${dict0}    typeName
    ${pointList}    get from dictionary    ${dict0}    pointList
    ${pointList0}    get from list    ${pointList}    0
    ${pName}    get from dictionary    ${pointList0}    pName
    ${pId}    get from dictionary    ${pointList0}    pId
    ${value}    get from dictionary    ${pointList0}    value
    ${unit}    get from dictionary    ${pointList0}    unit

GetEPInfo
    Create Session    api    http://10.232.234.210:8800
    ${userId}    Set Variable    ff8080816218fa3801626f5e554c00e0    #设置参数userId
    ${energyType}    Set Variable    0    #设置参数energyType
    ${addr}    get request    api    HyAppService.svc/GetEPInfo?userId=${userId}
    Should Be Equal As Strings    ${addr.status_code}    200    #判断请求响应是否为200，服务器成功返回网页
    log    ${addr.content}    #打印接口返回值
    ${responsedate}    to json    ${addr.content}    #使用to json将string转换为json串
    ${keys}    Get Dictionary Keys    ${responsedate}
    ${dict0}    get from list    ${responsedate}    0
    ${factoryGuid}    get from dictionary    ${dict0}    factoryGuid
    ${factoryName}    get from dictionary    ${dict0}    factoryName
    ${fh}    get from dictionary    ${dict0}    fh
    ${fhl}    get from dictionary    ${dict0}    fh
    ${list}    get from dictionary    ${dict0}    list
    ${machineData}    get from list    ${list}    0
    ${point}    get from dictionary    ${machineData}    point
    ${text}    get from dictionary    ${machineData}    text
    ${type}    get from dictionary    ${machineData}    type
    ${machineDatalist}    get from dictionary    ${machineData}    machineData
    ${machineDatalist0}    get from list    ${machineDatalist}    0
    ${value}    get from dictionary    ${machineDatalist0}    value
    ${pointId}    get from dictionary    ${machineDatalist0}    pointId
    ${deptGuid}    get from dictionary    ${machineDatalist0}    deptGuid

GetHcInfo
    Create Session    api    http://10.232.234.210:8800
    ${userId}    Set Variable    ff8080816218fa3801626f5e554c00e0    #设置参数userId
    ${dataType}    Set Variable    real    #设置参数dataType
    ${addr}    get request    api    HyAppService.svc/GetHcInfo?userId=${userId}&dataType=${dataType}
    Should Be Equal As Strings    ${addr.status_code}    200    #判断请求响应是否为200，服务器成功返回网页
    log    ${addr.content}    #打印接口返回值
    ${responsedate}    to json    ${addr.content}    #使用to json将string转换为json串
    ${keys}    Get Dictionary Keys    ${responsedate}
    ${dict0}    get from list    ${responsedate}    0
    ${FacName}    get from dictionary    ${dict0}    FacName
    ${mh}    get from dictionary    ${dict0}    mh
    ${pc}    get from dictionary    ${dict0}    pc
    ${mbz}    get from dictionary    ${dict0}    mbz
    ${guid}    get from dictionary    ${dict0}    guid
    ${macList}    get from dictionary    ${dict0}    macList
    ${macList0}    get from list    ${macList}    0
    ${fhl}    get from dictionary    ${macList0}    fhl
    ${guid}    get from dictionary    ${macList0}    guid
    ${machineCode}    get from dictionary    ${macList0}    machineCode
    ${mbz}    get from dictionary    ${macList0}    mbz
    ${mh}    get from dictionary    ${macList0}    mh
    ${pc}    get from dictionary    ${macList0}    pc
    ${state}    get from dictionary    ${macList0}    state
    ${macList1}    get from list    ${macList}    1
    ${fhl1}    get from dictionary    ${macList1}    fhl
    ${guid1}    get from dictionary    ${macList1}    guid
    ${machineCode1}    get from dictionary    ${macList1}    machineCode
    ${mbz1}    get from dictionary    ${macList1}    mbz
    ${mh1}    get from dictionary    ${macList1}    mh
    ${pc1}    get from dictionary    ${macList1}    pc
    ${state1}    get from dictionary    ${macList1}    state
    ${macList2}    get from list    ${macList}    2
    ${fhl2}    get from dictionary    ${macList2}    fhl
    ${guid2}    get from dictionary    ${macList2}    guid
    ${machineCode2}    get from dictionary    ${macList2}    machineCode
    ${mbz2}    get from dictionary    ${macList2}    mbz
    ${mh2}    get from dictionary    ${macList2}    mh
    ${pc2}    get from dictionary    ${macList2}    pc
    ${state2}    get from dictionary    ${macList2}    state
    ${macList3}    get from list    ${macList}    3
    ${fhl3}    get from dictionary    ${macList3}    fhl
    ${guid3}    get from dictionary    ${macList3}    guid
    ${machineCode3}    get from dictionary    ${macList3}    machineCode
    ${mbz3}    get from dictionary    ${macList3}    mbz
    ${mh3}    get from dictionary    ${macList3}    mh
    ${pc3}    get from dictionary    ${macList3}    pc
    ${state3}    get from dictionary    ${macList3}    state

GetZdInfo
    Create Session    api    http://10.232.234.210:8800
    ${deptGuid}    Set Variable    716ae514-95f8-4f14-8ef8-46fd6985a7b0    #设置参数deptGuid
    ${addr}    get request    api    HyAppService.svc/GetZdInfo?deptGuid=${deptGuid}
    Should Be Equal As Strings    ${addr.status_code}    200    #判断请求响应是否为200，服务器成功返回网页
    log    ${addr.content}    #打印接口返回值
    ${responsedate}    to json    ${addr.content}    #使用to json将string转换为json串
    ${keys}    Get Dictionary Keys    ${responsedate}
    ${dict0}    get from list    ${responsedate}    0
    ${WzValue}    get from dictionary    ${dict0}    WzValue
    ${WwValue}    get from dictionary    ${dict0}    WwValue
    ${XValue}    get from dictionary    ${dict0}    XValue
    ${YValue}    get from dictionary    ${dict0}    YValue
    ${No}    get from dictionary    ${dict0}    No

GetCompanyFdl
    Create Session    api    http://10.232.234.210:8800
    ${addr}    get request    api    HyAppService.svc/GetCompanyFdl
    Should Be Equal As Strings    ${addr.status_code}    200    #判断请求响应是否为200，服务器成功返回网页
    log    ${addr.content}    #打印接口返回值
    ${responsedate}    to json    ${addr.content}    #使用to json将string转换为json串
    ${keys}    Get Dictionary Keys    ${responsedate}
    ${dict0}    get from list    ${responsedate}    0
    ${day_fdl}    get from dictionary    ${dict0}    day_fdl
    ${deptGuid}    get from dictionary    ${dict0}    deptGuid
    ${energyType}    get from dictionary    ${dict0}    energyType
    ${month_fdl}    get from dictionary    ${dict0}    month_fdl
    ${name}    get from dictionary    ${dict0}    name
    ${year_fdl}    get from dictionary    ${dict0}    year_fdl

GetCompanyRealInfo
    Create Session    api    http://10.232.234.210:8800
    ${addr}    get request    api    HyAppService.svc/GetCompanyRealInfo
    Should Be Equal As Strings    ${addr.status_code}    200    #判断请求响应是否为200，服务器成功返回网页
    log    ${addr.content}    #打印接口返回值
    ${responsedate}    to json    ${addr.content}    #使用to json将string转换为json串
    ${keys}    Get Dictionary Keys    ${responsedate}
    ${items}    Get Dictionary items    ${responsedate}
    ${values}    Get Dictionary values    ${responsedate}
    ${fh}    get from dictionary    ${responsedate}    fh
    ${y_fdl}    get from dictionary    ${responsedate}    y_fdl

GetDwData
    Create Session    api    http://10.232.234.210:8800
    ${date}    Set Variable    2018-07-19    #设置参数date
    ${addr}    get request    api    HyAppService.svc/GetDwData?date=${date}
    Should Be Equal As Strings    ${addr.status_code}    200    #判断请求响应是否为200，服务器成功返回网页
    log    ${addr.content}    #打印接口返回值
    ${responsedate}    to json    ${addr.content}    #使用to json将string转换为json串
    ${keys}    Get Dictionary Keys    ${responsedate}
    ${dict0}    get from list    ${responsedate}    0
    ${d_v}    get from dictionary    ${dict0}    d_v
    ${m_v}    get from dictionary    ${dict0}    m_v
    ${name}    get from dictionary    ${dict0}    name
    ${dict1}    get from list    ${responsedate}    1
    ${d_v1}    get from dictionary    ${dict1}    d_v
    ${m_v1}    get from dictionary    ${dict1}    m_v
    ${name1}    get from dictionary    ${dict1}    name

*** Keywords ***
